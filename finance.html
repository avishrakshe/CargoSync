<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Completed Trip, Expense & Fuel Logging</title>
    <link rel="stylesheet" href="/static/expense.css">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">


</head>

<body>

    <!-- Sidebar Navigation -->
    <div class="sidebar">
        <div class="logo">
            <i class="fa-solid fa-truck-fast"></i> FleetFlow
        </div>
        <div class="nav-links">
            <a href="Dashboard.html"><i class="fa-solid fa-chart-line"></i> Dashboard</a>
            <a href="registry.html"><i class="fa-solid fa-warehouse"></i> Vehicle Registry</a>
            <a href="dispatcher.html"><i class="fa-solid fa-truck-ramp-box"></i> Trip Dispatcher</a>
            <a href="maintenance.html"><i class="fa-solid fa-screwdriver-wrench"></i> Maintenance & Service Logs</a>
            <a href="expense.html" class="active"><i class="fa-solid fa-file-invoice-dollar"></i> Completed Trip,
                Expense & Fuel Logging</a>
            <a href="perfomance.html"><i class="fa-solid fa-user-shield"></i> Driver Performance & Safety Profiles</a>
            <a href="finance.html"><i class="fa-solid fa-chart-pie"></i> Operational Analytics & Financial Reports</a>
        </div>
    </div>

    <!-- Main Content Area -->
    <div class="main-content">

        <div class="header">
            <h2>Completed Trip, Expense & Fuel Logging</h2>
            <p>Financial tracking per asset. Record Liters, Cost, and Date.</p>
        </div>

        <!-- Calculation Logic Banner -->
        <div class="calc-banner">
            <i class="fa-solid fa-calculator"></i>
            <strong>Automated Calculation:</strong> Total Operational Cost = (Fuel Expenses + Maintenance Costs) per
            Vehicle ID.
        </div>

        <!-- Financial Overview Summary -->
        <div class="financial-summary">
            <div class="summary-card">
                <h4>Total Fuel Cost (Month)</h4>
                <div class="amount">$12,450.00</div>
            </div>
            <div class="summary-card">
                <h4>Total Maintenance Cost</h4>
                <div class="amount">$4,320.00</div>
            </div>
            <div class="summary-card" style="background-color: #8e44ad20; border-color: #8e44ad;">
                <h4>Total Operational Cost</h4>
                <div class="amount" style="color: #8e44ad;">$16,770.00</div>
            </div>
        </div>

        <div class="dashboard-grid">

            <!-- LEFT COLUMN: Logging Forms -->
            <div class="left-column">

                <!-- Fuel Entry Form -->
                <div class="card">
                    <h3><i class="fa-solid fa-gas-pump"></i> Log Fuel Expense</h3>
                    <form method="post">
                        <input type="hidden" name="form_type" value="Fuel">
                        <div class="form-group">
                            <label>Vehicle ID</label>
                            <select class="form-control" name="vehicle_id">
                                <option value="">-- Select Vehicle --</option>
                                <option value="TRK-001">TRK-001</option>
                                <option value="VAN-042">VAN-042</option>
                                <option value="TRK-012">TRK-012</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Date</label>
                            <input type="date" class="form-control" name="date">
                        </div>
                        <div class="form-group">
                            <label>Liters Filled</label>
                            <input type="number" class="form-control" placeholder="0.00" name="liters_filled"
                                step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Total Cost ($)</label>
                            <input type="number" class="form-control" placeholder="0.00" name="total_cost" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Fuel Type</label>
                            <select class="form-control" name="fuel_type">
                                <option value="Diesel">Diesel</option>
                                <option value="Petrol (Gasoline)">Petrol (Gasoline)</option>
                                <option value="Electric">Electric</option>
                            </select>
                        </div>
                        <button type="submit" class="btn" name="log_fuel">Log Fuel</button>
                    </form>
                </div>

                <!-- Maintenance/Expense Entry -->
                <div class="card">
                    <h3><i class="fa-solid fa-receipt"></i> Log Other Expense</h3>
                    <form method="post">
                        <input type="hidden" name="form_type" value="Other">
                        <div class="form-group">
                            <label>Vehicle ID</label>
                            <select class="form-control" name="vehicle_id">
                                <option value="">-- Select Vehicle --</option>
                                <option value="TRK-001">TRK-001</option>
                                <option value="VAN-042">VAN-042</option>
                                <option value="TRK-012">TRK-012</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Expense Type</label>
                            <select class="form-control" name="expense_type">
                                <option value="Toll Fees">Toll Fees</option>
                                <option value="Parking">Parking</option>
                                <option value="Minor Repair">Minor Repair</option>
                                <option value="Cleaning">Cleaning</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Amount ($)</label>
                            <input type="number" class="form-control" placeholder="0.00" name="total_cost" step="0.01">
                        </div>
                        <button type="submit" class="btn" name="log_expense" style="background-color: #8e44ad;">Log
                            Expense</button>
                    </form>
                </div>
            </div>

            <!-- RIGHT COLUMN: Logs & Calculation Table -->
            <div class="right-column">

                <!-- Expense Logs -->
                <div class="card">
                    <h3><i class="fa-solid fa-list"></i> Expense & Fuel Log History</h3>
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Vehicle</th>
                                    <th>Type</th>
                                    <th>Liters</th>
                                    <th>Cost</th>
                                    <th>Category</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for row in data %}
                                <tr>
                                    <td>{{ row.date if row.date else 'N/A' }}</td>
                                    <td>{{ row.vehicle_id }}</td>
                                    <td>{{ row.fuel_type if row.form_type == 'Fuel' else row.expense_type }}</td>
                                    <td>{{ row.liters_filled ~ ' L' if row.liters_filled else '-' }}</td>
                                    <td>${{ row.total_cost }}</td>
                                    <td>
                                        <span
                                            class="status-badge {% if row.form_type == 'Fuel' %}badge-fuel{% else %}badge-expense{% endif %}">
                                            {{ row.form_type }}
                                        </span>
                                    </td>
                                </tr>
                                {% else %}
                                <tr>
                                    <td colspan="6" style="text-align: center; padding: 20px;">No expenses logged yet.
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Total Operational Cost Per Vehicle -->
                <div class="card">
                    <h3><i class="fa-solid fa-chart-pie"></i> Total Operational Cost per Vehicle</h3>
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Vehicle ID</th>
                                    <th>Total Fuel Cost</th>
                                    <th>Total Maint. Cost</th>
                                    <th>Total Operational Cost</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>TRK-001</strong></td>
                                    <td>$540.00</td>
                                    <td>$450.00</td>
                                    <td class="cost-highlight">$990.00</td>
                                </tr>
                                <tr>
                                    <td><strong>VAN-042</strong></td>
                                    <td>$288.00</td>
                                    <td>$120.00</td>
                                    <td class="cost-highlight">$408.00</td>
                                </tr>
                                <tr>
                                    <td><strong>TRK-012</strong></td>
                                    <td>$720.00</td>
                                    <td>$0.00</td>
                                    <td class="cost-highlight">$720.00</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div>

</body>

</html>